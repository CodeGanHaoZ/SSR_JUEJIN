"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const u=require("react"),le=require("prop-types"),ne=require("styled-components"),M=require("@strapi/icons"),re=require("../themes/sizes.cjs"),oe=require("./SelectButton.cjs"),ae=require("../Field/Field.cjs"),se=require("../Field/FieldLabel.cjs");require("../Field/FieldInput.cjs");const ie=require("../Field/FieldHint.cjs"),ce=require("../Field/FieldError.cjs");require("../Field/FieldContext.cjs");require("../Field/FieldAction.cjs");const de=require("../Popover/Popover.cjs"),ue=require("../Stack/Stack.cjs"),P=require("../Typography/Typography.cjs"),x=require("../Flex/Flex.cjs"),A=require("../Box/Box.cjs"),fe=require("../helpers/useId.cjs"),pe=require("./SelectList.cjs"),T=require("./components.cjs"),ye=require("./hooks/useButtonRef.cjs"),z=require("../VisuallyHidden/VisuallyHidden.cjs"),he=require("./constants.cjs"),G=require("../helpers/escapeSelector.cjs"),me=require("./SelectTags.cjs"),v=o=>o&&typeof o=="object"&&"default"in o?o:{default:o},l=v(u),e=v(le),Ee=v(ne),be=Ee.default(x.Flex)`
  width: 100%;
`,I=({label:o,labelAction:W,id:N,children:J,customizeContent:y,placeholder:g,onChange:F,value:n,hint:S,error:p,disabled:i,clearLabel:C,onClear:O,onReachEnd:K,multi:a,required:Q,selectButtonTitle:U,size:V,startIcon:R,withTags:h,...X})=>{const r=fe.useId(N),[m,E]=u.useState(void 0),L=ye.useButtonRef(m),$=u.useRef(null),_=`${r}-label`,b=`${r}-content`,Y=typeof p=="string";let j;if(p?j=`${r}-error`:S&&(j=`${r}-hint`),h&&!a)throw new Error('The "withTags" props can only be used when the "multi" prop is present');const Z=()=>{E(void 0)},ee=()=>{i||(O(),L.current.focus())},k=t=>{t.preventDefault(),!i&&(t.nativeEvent.which===3||t.nativeEvent.button===2||E(he.DownState.Mouse))},q=(t,s=!0)=>{a?F(n.includes(t)?n.filter(c=>c!==t):[...n,t]):(F(t),s&&E(void 0))},D=t=>{F(n.includes(t[0])?n.filter((s,c,f)=>f.indexOf(s)<0,t):[...n,...t])};let B,w=[];const H=(t,s)=>{const c=`${r}-option-${t.props.value}`,f=a?n.includes(t.props.value):t.props.value===n;return f&&(h?w.push({label:t.props.children,value:t.props.value}):B=t.props.children),u.cloneElement(t,{id:G.escapeSelector(c),onClick:()=>q(t.props.value),selected:f,multi:a,isChild:s})},te=u.Children.toArray(J).map(t=>{if(t.type.displayName==="OptGroup"){const s=`${r}-option-${t.props.label}`,c=t.props.children.every(d=>n.includes(d.props.value)),f=!c&&t.props.children.some(d=>n.includes(d.props.value));return u.cloneElement(t,{id:G.escapeSelector(s),onClick:()=>D(t.props.children.map(d=>d.props.value)),selected:c,indeterminate:f,multi:a,children:u.Children.toArray(t.props.children).map(d=>H(d,!0)),value:t.props.label})}return H(t)});return l.default.createElement(ae.Field,{hint:S,error:p,id:r,required:Q},l.default.createElement(ue.Stack,{spacing:o||S||Y?1:0},o&&l.default.createElement(se.FieldLabel,{action:W},o),l.default.createElement(T.SelectButtonWrapper,{size:V,hasError:Boolean(p),disabled:i,ref:$},l.default.createElement(oe.SelectButton,{ref:L,labelledBy:`${r} ${_} ${b}`,"aria-describedby":j,expanded:Boolean(m),onTrigger:E,id:r,hasError:Boolean(p),disabled:i,onMouseDown:k,...X}),l.default.createElement(be,{justifyContent:"space-between"},l.default.createElement(x.Flex,null,R&&l.default.createElement(A.Box,{paddingLeft:3,"aria-hidden":!0},R),h&&l.default.createElement(me.SelectTags,{tags:w,onRemoveTag:q,disabled:i}),l.default.createElement(A.Box,{paddingLeft:4,paddingRight:4},h?l.default.createElement(l.default.Fragment,null,!n||n.length===0?l.default.createElement(P.Typography,{ellipsis:!0,id:b,textColor:"neutral600"},g):null,l.default.createElement(z.VisuallyHidden,{as:"span",id:b},y?y(n):B||g,n.join(", "))):l.default.createElement(P.Typography,{ellipsis:!0,id:b,textColor:n?"neutral800":"neutral600"},y?y(n):B||g,a&&l.default.createElement(z.VisuallyHidden,{as:"span"},n.join(", "))))),l.default.createElement(x.Flex,null,(a&&n&&n.length||!a&&n)&&O&&l.default.createElement(T.IconBox,{as:"button",type:"button",onClick:ee,"aria-label":C,"aria-disabled":i,title:C},l.default.createElement(M.Cross,null)),l.default.createElement(T.CaretBox,{paddingLeft:3,"aria-hidden":!0,as:"button",type:"button",onMouseDown:k,tabIndex:-1,disabled:i,title:U},l.default.createElement(M.CarretDown,null))))),l.default.createElement(ie.FieldHint,null),l.default.createElement(ce.FieldError,null)),m&&l.default.createElement(de.Popover,{source:$,spacing:4,fullWidth:!0,intersectionId:`select-list-intersection-${r}`,onReachEnd:K},l.default.createElement(pe.SelectList,{selectId:r,labelledBy:o?_:void 0,onEscape:Z,expanded:m,onSelectItem:(t,s)=>s?D(t):q(t,!1),multi:a},te)))};I.defaultProps={"aria-label":void 0,children:[],clearLabel:"Clear",customizeContent:void 0,disabled:!1,id:void 0,label:void 0,labelAction:void 0,multi:!1,onChange(){},onClear:void 0,onReachEnd:void 0,value:void 0,hint:void 0,error:void 0,placeholder:"Select...",required:!1,selectButtonTitle:"Carret Down Button",size:"M",startIcon:void 0,withTags:!1};I.propTypes={"aria-label":e.default.string,children:e.default.oneOfType([e.default.arrayOf(e.default.node),e.default.node]),clearLabel:e.default.string,customizeContent:e.default.func,disabled:e.default.bool,error:e.default.oneOfType([e.default.string,e.default.bool]),hint:e.default.oneOfType([e.default.string,e.default.bool,e.default.node,e.default.arrayOf(e.default.node)]),id:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.string,labelAction:e.default.element,multi:e.default.bool,onChange:e.default.func,onClear:e.default.func,onReachEnd:e.default.func,placeholder:e.default.string,required:e.default.bool,selectButtonTitle:e.default.string,size:e.default.oneOf(Object.keys(re.sizes.input)),startIcon:e.default.element,value:e.default.oneOfType([e.default.arrayOf(e.default.oneOfType([e.default.string,e.default.number])),e.default.string,e.default.number]),withTags:e.default.bool};exports.Select=I;
